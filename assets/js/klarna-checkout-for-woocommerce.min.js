jQuery(function(e){if("undefined"==typeof klarna_checkout_for_woocommerce_params)return!1;var o={bodyEl:e("body"),checkoutFormSelector:"form.checkout",orderNotesValue:"",orderNotesSelector:"textarea#order_comments",orderNotesEl:e("textarea#order_comments"),paymentMethodEl:e('input[name="payment_method"]'),paymentMethod:"",selectAnotherSelector:"#klarna-checkout-select-other",documentReady:function(){o.paymentMethodEl.length>0?o.paymentMethod=o.paymentMethodEl.filter(":checked").val():o.paymentMethod="klarna_checkout_for_woocommerce"},kcoSuspend:function(){window._klarnaCheckout(function(e){e.suspend()})},kcoResume:function(){window._klarnaCheckout(function(e){e.resume()})},updateCart:function(){o.kcoSuspend(),e("body").trigger("update_checkout"),e.ajax({type:"POST",url:klarna_checkout_for_woocommerce_params.update_cart_url,data:{checkout:e("form.checkout").serialize(),nonce:klarna_checkout_for_woocommerce_params.update_cart_nonce},dataType:"json",success:function(e){},error:function(e){},complete:function(e){o.kcoResume()}})},updateShipping:function(){o.kcoSuspend(),e("body").trigger("update_checkout");var c={};e('select.shipping_method, input[name^="shipping_method"][type="radio"]:checked, input[name^="shipping_method"][type="hidden"]').each(function(){c[e(this).data("index")]=e(this).val()}),e.ajax({type:"POST",url:klarna_checkout_for_woocommerce_params.update_shipping_url,data:{shipping:c,nonce:klarna_checkout_for_woocommerce_params.update_shipping_nonce},success:function(e){},error:function(e){},complete:function(e){o.kcoResume()}})},updateOrderNotes:function(){o.orderNotesEl.val()!==o.orderNotesValue&&(o.orderNotesValue=o.orderNotesEl.val(),e.ajax({type:"POST",url:klarna_checkout_for_woocommerce_params.update_order_notes_url,data:{order_notes:o.orderNotesValue,nonce:klarna_checkout_for_woocommerce_params.update_order_notes_nonce},success:function(e){},error:function(e){},complete:function(e){console.log("complete",e)}}))},refreshCheckoutFragment:function(c){c.preventDefault(),e(o.checkoutFormSelector).block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),e.ajax({type:"POST",dataType:"json",data:{kco:!1,nonce:klarna_checkout_for_woocommerce_params.refresh_checkout_fragment_nonce},url:klarna_checkout_for_woocommerce_params.refresh_checkout_fragment_url,success:function(e){},error:function(e){},complete:function(e){console.log(e.responseJSON),window.location.href=e.responseJSON.data.redirect}})},refreshCheckoutFragmentKco:function(){console.log(e(this).val()),"klarna_checkout_for_woocommerce"===e(this).val()&&(e(".woocommerce-info").remove(),e(o.checkoutFormSelector).block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),e.ajax({type:"POST",data:{kco:!0,nonce:klarna_checkout_for_woocommerce_params.refresh_checkout_fragment_nonce},dataType:"json",url:klarna_checkout_for_woocommerce_params.checkout_url+"?wc-ajax=kco_wc_refresh_checkout_fragment",success:function(e){},error:function(e){},complete:function(e){console.log(e.responseJSON),window.location.href=e.responseJSON.data.redirect}}))},init:function(){e(document).ready(o.documentReady),o.bodyEl.on("change","input.qty",o.updateCart),o.bodyEl.on("change","input.shipping_method",o.updateShipping),o.bodyEl.on("blur",o.orderNotesSelector,o.updateOrderNotes),o.bodyEl.on("change",'input[name="payment_method"]',o.refreshCheckoutFragmentKco),o.bodyEl.on("click",o.selectAnotherSelector,o.refreshCheckoutFragment)}};o.init()});